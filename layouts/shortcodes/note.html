{{/* Usage: 
  ……Text{{< note >}}Footnote{{< /note >}}text continue……

*/}}

{{- $idx := add 1 (default 0 (.Page.Scratch.Get "noteIndex")) -}}
{{- .Page.Scratch.Set "noteIndex" $idx -}}

{{- $html := .Inner | markdownify -}}
{{- $plain := $html | plainify -}}

{{- $notes := default (slice) (.Page.Scratch.Get "notes") -}}
{{- $notes = $notes | append (dict "id" $idx "html" $html "plain" $plain) -}}
{{- .Page.Scratch.Set "notes" $notes -}}

<sup id="ref-{{ $idx }}">
  <a href="#note-{{ $idx }}" class="note-ref" data-note="{{ $plain | htmlEscape | safeHTMLAttr }}">[{{ $idx }}]</a>
</sup>
